---
sidebar_position: 12
---

# Vue-Pinia

æ–‡æ¡£åœ°å€:[pinia](https://pinia.vuejs.org/)

> äº‹å®ä¸Šçš„VueX5, ä»£æ›¿VueXæˆä¸ºVue3çš„å®˜ç½‘çŠ¶æ€ç®¡ç†åº“
- å…¼å®¹æ€§æ›´å¥½,æ”¯æŒVue2, Vue3
- å®ƒé‡‡ç”¨äº†æ–°çš„å“åº”å¼ç³»ç»Ÿï¼Œè€Œä¸”æ„å»ºäº†ä¸€å¥—å…¨æ–°çš„ Composition API
- å†™æ³•æ›´ç®€å•, åˆ é™¤ `mutations`ï¼Œåªæ”¯æŒ `state`ã€`getters`ã€`actions`
- é¡¹ç›®è¦ä½¿ç”¨ Vue3 è¿›è¡Œå¼€å‘ï¼Œæ¨èæ— è„‘ä½¿ç”¨ Piniaï¼Œæ›´åŠ ç®€æ´ï¼Œè€Œä¸”å¤§å°ä»… 1KB

:::info çŠ¶æ€ç®¡ç†
æŠŠéœ€è¦`å…¬ç”¨çš„çŠ¶æ€ `æ”¾åœ¨`å…¬å…±çš„ä»“åº“` ä»¥æä¾› ä»»æ„ç»„ä»¶ä½¿ç”¨

:::

## å®‰è£…
```bash
# npm
npm i pinia@next
# yarn
yarn add pinia@next
# pnpm
pnpm i pinia@next
```

## å¼•å…¥

```js
// main.js
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'

// å®ä¾‹åŒ– Vue
const app = createApp(App)
// å®‰è£… Pinia
app.use(createPinia())
// æŒ‚è½½åœ¨çœŸå® DOM
app.mount('#app')
```

## ä½¿ç”¨

### å®šä¹‰ Store

> ä¼ ç»ŸVueXç‰ˆå†™æ³•

```js
// store.js
import { defineStore } from "pinia"

// å¯¹å¤–éƒ¨æš´éœ²ä¸€ä¸ª use æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå¯¼å‡ºæˆ‘ä»¬å®šä¹‰çš„ state
const useCounterStore = defineStore({
  // æ¯ä¸ª store çš„ id å¿…é¡»å”¯ä¸€
  id: 'counter',
  // state è¡¨ç¤ºæ•°æ®æº
  state: () => ({
    count: 0
  }),
  // getters ç±»ä¼¼äº computedï¼Œå¯å¯¹ state çš„å€¼è¿›è¡ŒäºŒæ¬¡è®¡ç®—
  getters: {
    double () {
        // getter ä¸­çš„ this æŒ‡å‘ğŸ‘‰ state
        return this.count * 2
      },
      // å¦‚æœä½¿ç”¨ç®­å¤´å‡½æ•°ä¼šå¯¼è‡´ this æŒ‡å‘æœ‰é—®é¢˜
      // å¯ä»¥åœ¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸­æ‹¿åˆ° state
    double: (state) => {
        return state.count * 2
      }
  },
  // actions ç”¨æ¥ä¿®æ”¹ state
  actions: {
    increment() {
      // action ä¸­çš„ this æŒ‡å‘ğŸ‘‰ state
      this.count++
    },
  }
})

export default useCounterStore
```

> ä½¿ç”¨ function çš„å½¢å¼æ¥åˆ›å»º store

```js
import { ref, computed } from "vue"
import { defineStore } from "pinia"

// å¯¹å¤–éƒ¨æš´éœ²ä¸€ä¸ª use æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå¯¼å‡ºæˆ‘ä»¬å®šä¹‰çš„ state
const useCounterStore = defineStore('counter', function () {
  const count = ref(0)
  const double = computed(() => count.value * 2)
  function increment() {
    count.value++
  }
  return {
      count, double, increment
  }
})

export default useCounterStore
```

### ä½¿ç”¨store
:::warning æ³¨æ„äº‹é¡¹
Composition Api ä¸­ï¼Œä¸ç®¡æ˜¯ `state `è¿˜æ˜¯ `getter` éƒ½éœ€è¦é€šè¿‡ `computed` æ–¹æ³•æ¥ç›‘å¬å˜åŒ–
:::

```js
// Composition Api
import { computed } from 'vue'
import { useCounterStore } from '../stores/counter'
export default {
  name: 'HelloWorld',
  setup() {
    const counter = useCounterStore()
    return {
      // state å’Œ getter éƒ½éœ€è¦åœ¨ä½¿ç”¨ computedï¼Œè¿™å’Œ Options Api ä¸€æ ·
      count: computed(() => counter.count),
      double: computed(() => counter.double),
      increment: () => { counter.count++ }, // å¯ä»¥ç›´æ¥ä¿®æ”¹ state çš„å€¼
      increment: counter.increment, // å¯ä»¥å¼•ç”¨ store ä¸­å®šä¹‰çš„ action
    }
  }
}
```


### æ¨¡å—å¤„ç†

ä½¿ç”¨ defineStore å®šä¹‰ä¸¤ä¸ª å®Œå…¨æ˜¯åˆ†ç¦»çŠ¶æ€çš„ storeï¼Œä¸¤ä¸ªé¡µé¢åœ¨å¼•å…¥æ—¶ï¼Œä¹Ÿäº’ä¸å½±å“ã€‚æœ€åæ‰“åŒ…çš„æ—¶å€™ï¼Œé¦–é¡µçš„ js chunk å’Œå•†å“é¡µçš„ js chunk ä¼šåˆ†åˆ«æ‰“åŒ…å¯¹åº”çš„ store