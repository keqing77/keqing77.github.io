---
sidebar_position: 7
---

# useReducer

> Reduxçš„ä»£æ›¿å“, ä½†ä¾ç„¶éš¾ç”¨ğŸ˜

## usage
`const [state, dispatch] = useReducer(reducer, initialArg, init)`

> useReducerè¿”å›ä¸€ä¸ªæ­£å¥½æœ‰ä¸¤ä¸ªé¡¹ç›®çš„æ•°ç»„ã€‚

- è¿™ä¸ªçŠ¶æ€å˜é‡çš„å½“å‰çŠ¶æ€ï¼Œæœ€åˆè®¾ç½®ä¸ºä½ æä¾›çš„`åˆå§‹çŠ¶æ€(state)`ã€‚
- è®©ä½ æ”¹å˜å®ƒä»¥å“åº”äº¤äº’çš„`è°ƒåº¦å‡½æ•°(dispatch)`
- è¦æ›´æ–°å±å¹•ä¸Šçš„å†…å®¹ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªä»£è¡¨ç”¨æˆ·è¡Œä¸ºçš„å¯¹è±¡(dispatch)æ¥è°ƒç”¨è°ƒåº¦ï¼Œç§°ä¸º`è¡ŒåŠ¨(action)`
- Reactä¼šå°†å½“å‰çŠ¶æ€å’ŒåŠ¨ä½œä¼ é€’ç»™ä½ çš„reducerå‡½æ•°ã€‚ä½ çš„reducerå‡½æ•°å°†è®¡ç®—å¹¶è¿”å›ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚
- Reactå°†å­˜å‚¨ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œç”¨å®ƒæ¸²æŸ“ä½ çš„ç»„ä»¶ï¼Œå¹¶æ›´æ–°UI

:::info ä½¿ç”¨æ–¹æ³•
- Adding a reducer to a component (ç»™ç»„ä»¶æ·»åŠ ä¸€ä¸ªreducer)
- Writing the reducer function (ç¼–å†™reducerå‡½æ•°)
- Avoiding recreating the initial state (é¿å…é‡æ–°åˆ›å»ºåˆå§‹çŠ¶æ€)
:::

### 1. ç»™ç»„ä»¶æ·»åŠ ä¸€ä¸ªreducer
```jsx
import { useReducer } from 'react';

function reducer(state, action) {
  // ...
}

function MyComponent() {
  const [state, dispatch] = useReducer(reducer, { age: 42 });
  // ...
```

### 2. ç¼–å†™reducerå‡½æ•°

```jsx
import { useReducer } from 'react';

function reducer(state, action) {
  if (action.type === 'incremented_age') {
    return {
      age: state.age + 1
    };
  }
  throw Error('Unknown action.');
}

export default function Counter() {
  const [state, dispatch] = useReducer(reducer, { age: 42 });

  return (
    <>
      <button onClick={() => {
        dispatch({ type: 'incremented_age' })
      }}>
        Increment age
      </button>
      <p>Hello! You are {state.age}.</p>
    </>
  );
}
```



### 3. é¿å…é‡æ–°åˆ›å»ºåˆå§‹çŠ¶æ€

Reactä¿å­˜äº†ä¸€æ¬¡åˆå§‹çŠ¶æ€ï¼Œå¹¶åœ¨æ¥ä¸‹æ¥çš„æ¸²æŸ“ä¸­å¿½ç•¥äº†å®ƒ

```jsx
function createInitialState(username) {
  // ...
}

function TodoList({ username }) {
  const [state, dispatch] = useReducer(reducer, createInitialState(username));
  // ...
```


**å°½ç®¡createInitialState(username)çš„ç»“æœåªç”¨äºåˆå§‹æ¸²æŸ“ï¼Œä½†ä½ ä»ç„¶åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å¦‚æœå®ƒè¦åˆ›å»ºå¤§å‹æ•°ç»„æˆ–è¿›è¡Œæ˜‚è´µçš„è®¡ç®—ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ç§æµªè´¹ã€‚
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥æŠŠå®ƒä½œä¸ºåˆå§‹åŒ–å‡½æ•°ä¼ é€’ç»™useReducerï¼Œä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°æ¥ä»£æ›¿**


```jsx
function createInitialState(username) {
  // ...
}

function TodoList({ username }) {
  const [state, dispatch] = useReducer(reducer, username, createInitialState);
  // ...
```

**æ³¨æ„ï¼Œä½ ä¼ é€’çš„æ˜¯createInitialStateï¼Œå³å‡½æ•°æœ¬èº«ï¼Œè€Œä¸æ˜¯createInitialState()ï¼Œå³è°ƒç”¨å®ƒçš„ç»“æœã€‚è¿™æ ·ä¸€æ¥ï¼Œåˆå§‹åŒ–åçš„åˆå§‹çŠ¶æ€å°±ä¸ä¼šè¢«é‡æ–°åˆ›å»ºäº†ã€‚
åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒcreateInitialStateéœ€è¦ä¸€ä¸ªç”¨æˆ·åå‚æ•°ã€‚å¦‚æœä½ çš„åˆå§‹åŒ–å™¨ä¸éœ€è¦ä»»ä½•ä¿¡æ¯æ¥è®¡ç®—åˆå§‹çŠ¶æ€ï¼Œä½ å¯ä»¥ä¼ é€’nullä½œä¸ºuseReducerçš„ç¬¬äºŒä¸ªå‚æ•°ã€‚**