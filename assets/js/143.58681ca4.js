(window.webpackJsonp=window.webpackJsonp||[]).push([[143],{658:function(t,e,s){"use strict";s.r(e);var o=s(13),a=Object(o.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"跨站请求伪造-cross-site-request-forgery"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#跨站请求伪造-cross-site-request-forgery"}},[t._v("#")]),t._v(" 跨站请求伪造（Cross-site request forgery）")]),t._v(" "),s("p",[t._v("跨站请求伪造（CSRF）是一种冒充受信任用户，向服务器发送非预期请求的攻击方式。例如，这些非预期请求可能是通过在跳转链接后的 URL 中加入恶意参数来完成:")]),t._v(" "),s("p",[s("code",[t._v('<img src="https://www.example.com/index.php?action=delete&id=123">')])]),t._v(" "),s("p",[t._v("对于在 https://www.example.com 有权限的用户，这个 "),s("img"),t._v(" 标签会在他们根本注意不到的情况下对 https://www.example.com 执行这个操作，即使这个标签根本不在 https://www.example.com 内亦可。")]),t._v(" "),s("p",[t._v("有很多预防 CSRF 的方法，比如实现 RESTful API，增加 secure token 等等\n"),s("strong",[t._v("简单点说，CSRF 就是利⽤⽤户的登录态发起恶意请求")])]),t._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[t._v("CSRF攻击原理")]),t._v(" "),s("br")]),t._v(" "),s("p",[t._v("一个典型的CSRF攻击有着如下的流程：")]),t._v(" "),s("ul",[s("li",[t._v("受害者登录a.com，并保留了登录凭证（Cookie）。")]),t._v(" "),s("li",[t._v("攻击者引诱受害者访问了b.com。")]),t._v(" "),s("li",[t._v("b.com 向 a.com 发送了一个请求：a.com/act=xx。浏览器会默认携带a.com的Cookie。")]),t._v(" "),s("li",[t._v("a.com接收到请求后，对请求进行验证，并确认是受害者的凭证，误以为是受害者自己发送的请求。")]),t._v(" "),s("li",[t._v("a.com以受害者的名义执行了act=xx。")]),t._v(" "),s("li",[t._v("攻击完成，攻击者在受害者不知情的情况下，冒充受害者，让a.com执行了自己定义的操作。")])]),t._v(" "),s("div",{staticClass:"custom-block warning"},[s("p",{staticClass:"custom-block-title"},[t._v("CSRF的攻击类型")]),t._v(" "),s("br")]),t._v(" "),s("ul",[s("li",[t._v("GET类型的CSRF")]),t._v(" "),s("li",[t._v("POST类型的CSRF")]),t._v(" "),s("li",[t._v("连接类型的CSRF")])]),t._v(" "),s("p",[t._v("参考链接"),s("a",{attrs:{href:"https://tech.meituan.com/2018/10/11/fe-security-csrf.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("美团技术博客-CSRF"),s("OutboundLink")],1)]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("防御CSRF")]),t._v(" "),s("br")]),t._v(" "),s("div",{staticClass:"theorem"},[s("p",{staticClass:"title"},[t._v("防范 CSRF 可以遵循以下⼏种规则：")]),s("ol",[s("li",[t._v("Get 请求不对数据进⾏修改")]),t._v(" "),s("li",[t._v("不让第三⽅⽹站访问到⽤户 Cookie")]),t._v(" "),s("li",[t._v("阻⽌第三⽅⽹站请求接⼝")]),t._v(" "),s("li",[t._v("请求时附带验证信息，⽐如验证码或者 token")])]),t._v(" "),s("h4",{attrs:{id:"samesite"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#samesite"}},[t._v("#")]),t._v(" SameSite")]),t._v(" "),s("p",[t._v("可以对 Cookie 设置"),s("code",[t._v("SameSite")]),t._v(" 属性。该属性设置 Cookie 不随着跨域请求发送，该属性可以\n很⼤程度减少 CSRF 的攻击，但是该属性⽬前并不是所有浏览器都兼容。")]),t._v(" "),s("p",[t._v("SameSite 可以设置为三个值， "),s("code",[t._v("Strict 、 Lax 和 None")]),t._v(" 。")]),t._v(" "),s("ol",[s("li",[t._v("在 Strict 模式下，浏览器完全禁止第三方请求携带Cookie。比如请求 sanyuan.com 网站只能在\nsanyuan.com 域名当中请求才能携带 Cookie，在其他网站请求都不能。")]),t._v(" "),s("li",[t._v("在 Lax 模式，就宽松一点了，但是只能在 get 方法提交表单 况或者 a 标签发送 get 请求 的情况下可\n以携带 Cookie，其他情况均不能。")]),t._v(" "),s("li",[t._v("在 None 模式下，也就是默认模式，请求会自动携带上 Cookie。")])]),t._v(" "),s("p",[t._v("验证 Referer\n对于需要防范 CSRF 的请求，我们可以通过验证 Referer 来判断该请求是否为第三⽅⽹站发\n起的。")]),t._v(" "),s("h4",{attrs:{id:"token"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#token"}},[t._v("#")]),t._v(" Token")]),t._v(" "),s("p",[t._v("服务器下发⼀个随机 Token（算法不能复杂），每次发起请求时将 Token 携带上，服务器验\n证 Token 是否有效。\n密码安全\n密码安全虽然⼤多是后端的事情，但是作为⼀名优秀的前端程序员也需要熟悉这⽅⾯的知\n识。")]),t._v(" "),s("h4",{attrs:{id:"密码加盐"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#密码加盐"}},[t._v("#")]),t._v(" 密码加盐")]),t._v(" "),s("p",[t._v("对于密码存储来说，必然是不能明⽂存储在数据库中的，否则⼀旦数据库泄露，会对⽤户造\n成很⼤的损失。并且不建议只对密码单纯通过加密算法加密，因为存在彩虹表的关系。\n通常需要对密码加盐，然后进⾏⼏次不同加密算法的加密。\n// 加盐也就是给原密码添加字符串，增加原密码⻓度\nsha256(sha1(md5(salt + password + salt)))\n但是加盐并不能阻⽌别⼈盗取账号，只能确保即使数据库泄露，也不会暴露⽤户的真实密\n码。⼀旦攻击者得到了⽤户的账号，可以通过暴⼒破解的⽅式破解密码。对于这种情况，通\n常使⽤验证码增加延时或者限制尝试次数的⽅式。并且⼀旦⽤户输⼊了错误的密码，也不能\n直接提示⽤户输错密码，⽽应该提示账号或密码错误。")]),t._v(" "),s("div",{staticClass:"custom-block right"},[s("p",[s("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Glossary/CSRF",target:"_blank",rel:"noopener noreferrer"}},[t._v("CSRF"),s("OutboundLink")],1)])])])])}),[],!1,null,null,null);e.default=a.exports}}]);